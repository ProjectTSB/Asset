#> asset:object/1086.lightning_exploit/init/
#
# Objectのinit時の処理
#
# @within asset:object/alias/1086/init

#> private
# @private
    #declare score_holder $OwnerID
    #declare tag SpreadMarker

# 雪玉を殴る（描画更新で）
    damage @e[type=snowball,tag=1086.Snowball,tag=1086.Init,distance=..3,sort=nearest,limit=1] 1

# タグ付け。initタグくれよ
    tag @s add 1086.Init

    execute store result score $OwnerID Temporary run data get storage asset:context this.UserID
    execute at @a if score $OwnerID Temporary = @p UserID as @p run tag @s add 1086.Owner

# 前方拡散してから
    summon marker ~ ~ ~ {Tags:["SpreadMarker"]}
    data modify storage lib: Argument.Distance set value 1
    data modify storage lib: Argument.Spread set value 0.3
    execute as @e[type=marker,tag=SpreadMarker,distance=..10,sort=nearest,limit=1] rotated as @p[tag=1086.Owner] run function lib:forward_spreader/circle

# モーションでぶっ飛ばす。飛ぶのは下の雪玉
    data modify storage lib: Argument.VectorMagnitude set value 0.8
    execute facing entity @e[type=marker,tag=SpreadMarker,distance=..10,sort=nearest,limit=1] feet as @e[type=snowball,tag=1086.Snowball,tag=1086.Init,distance=..3,sort=nearest,limit=1] run function lib:motion/
    data remove storage lib: Argument

# タグ消す
    tag @s remove 1086.Init
    tag @p[tag=1086.Owner] remove 1086.Owner
    tag @e[type=snowball,tag=1086.Snowball,tag=1086.Init,distance=..3,sort=nearest,limit=1] remove 1086.Init

# リセット
    kill @e[type=marker,tag=SpreadMarker,distance=..10]
